knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(broom)
head(main_dat)
main_dat <- read.csv('galton_child_parent_heights.csv')
head(main_dat)
z-score(x) <- (x-mean(x))/sd(x)
z-score(x) = (x-mean(x))/sd(x)
z-score(x) == (x-mean(x))/sd(x)
z-score <- function(x) {(x-mean(x))/sd(x)}
z_score <- function(x) {(x-mean(x))/sd(x)}
main_dat$z_child_ht <- z_score(main_dat$child_ht)
main_dat$z_parent_ht <- z_score(main_dat$parent_ht)
head(main_dat)
install.packages(corrr)
library(corrr)
install.packages("corrr")
correlate(main_dat)
library(corrr)
correlate(main_dat)
cor_main <- correlate(main_dat)
cor_main_matrix <- correlate(main_dat)
cor(main_dat)
correlate(main_dat)
rplot(main_dat)
rplot(cor_main_matrix)
library(ggplot2)
ggplot(child_parent_df, aes(x = parent_ht, y = child_ht))
ggplot(main_dat, aes(x = parent_ht, y = child_ht))
ggplot(main_dat, aes(x = z_parent_ht, y = z_child_ht))
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_smooth(method = 'lm')
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_smooth(method = 'lm') +
annotate("text", x = 5, y = 80, label = "r = 0.459", color = "darkgreen", size = 5)
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_smooth(method = 'lm') +
annotate("text", x = 25, y = 50, label = "r = 0.459", color = "darkgreen", size = 5)
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_smooth(method = 'lm') +
#annotate("text", x = 25, y = 50, label = "r = 0.459", color = "darkgreen", size = 5)
ggplot(main_dat, aes(x = z_parent_ht, y = z_child_ht)) +
geom_smooth(method = 'lm')
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_smooth(method = 'lm')
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_smooth(method = 'lm') +
annotate("text", x = 70, y = 70, label = "r = 0.459", color = "darkgreen", size = 5)
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_smooth(method = 'lm') +
annotate("text", x = 69, y = 70, label = "r = 0.459", color = "darkgreen", size = 5)
ggplot(main_dat, aes(x = z_parent_ht, y = z_child_ht)) +
geom_smooth(method = 'lm') +
annotate("text", x = 69, y = 70, label = "r = 0.459", color = "darkgreen", size = 5)
ggplot(main_dat, aes(x = z_parent_ht, y = z_child_ht)) +
geom_smooth(method = 'lm') #+
ggplot(main_dat, aes(x = z_parent_ht, y = z_child_ht)) +
geom_smooth(method = 'lm') +
annotate("text", x = 0, y = 1, label = "r = 0.459", color = "darkgreen", size = 5)
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_smooth(method = 'lm') +
annotate("text", x = 69, y = 70, label = "r = 0.459", color = "darkgreen", size = 5)
ggplot(main_dat, aes(x = parent_ht, y = child_ht))
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_smooth(method = 'lm') +
annotate("text", x = 69, y = 70, label = "r = 0.459", color = "darkgreen", size = 5)
parent2child <- lm(child_ht ~ parent_ht, data = main_dat)
parent_z2child_z <- lm(z_child_ht ~ z_parent_ht, data = main_dat)
print(parent2child)
summary(parent2child)
print(parent2child)
print(parent_z2child_z)
summary(parent_z2child_2)
summary(parent_z2child_z)
summary(parent2child)
summary(parent_z2child_z)
print(parent_z2child_z)
summary(parent2child)
print(parent2child)
library(broom)
tidy(parent2child)
tidy(parent_z2child_z)
tidy(parent2child)
tidy(parent_z2child_z)
tidy(parent2child)
tidy(parent2child)
tidy(parent_z2child_z)
tidy(parent2child)
tidy(parent_z2child_z)
rplot(cor_main_matrix)
glance(parent2child)
glance(parent_z2child_z)
glance(parent_z2child_z)
glance(parent2child)
glance(parent2child)
glance(parent_z2child_z)
```
glance(parent_z2child_z)
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_jitter(alpha = 0.3)
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_jitter(alpha = 0.3) +
geom_smooth(method = 'lm') +
annotate("text", x = 69, y = 70, label = "r = 0.459", color = "darkgreen", size = 5)
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_jitter(alpha = 0.3) +
geom_smooth(method = 'lm') +
annotate("text", x = 65, y = 72, label = "r = 0.459", color = "darkgreen", size = 5)
ggplot(main_dat, aes(x = z_parent_ht, y = z_child_ht)) +
geom_jitter(alpha = 0.3) +
geom_smooth(method = 'lm') +
annotate("text", x = 0, y = 1, label = "r = 0.459", color = "darkgreen", size = 5)
ggplot(main_dat, aes(x = z_parent_ht, y = z_child_ht)) +
geom_jitter(alpha = 0.3) +
geom_smooth(method = 'lm') +
annotate("text", x = -2, y = 1, label = "r = 0.459", color = "darkgreen", size = 5)
augment(parent2child)
augment(parent2child, data = main_dat)
augment(parent_z2child_z)
augment(parent_z2child_z, data = main_dat)
augment(parent2child)
augment(parent2child, data = main_dat)
augment(parent2child)
augment(parent2child, data = main_dat)
var(parent2child$fitted)
augment(parent2child)
augment(parent2child, data = main_dat)
var(parent2child$fitted) #fitted data
var(parent2child$child_ht) #observed data
var(parent2child$child_ht) #observed data
var(parent2child$resid) #residuals
augment(parent2child, data = main_dat)
augment(parent_z2child_z, data = main_dat)
var(parent_z2child_z$fitted) #fitted data
var(parent_z2child_z$child_ht) #observed data
var(parent_z2child_z$resid) #residuals
var(main_dat$child_ht) #observed data
var(parent2child$fitted) #fitted data
var(main_dat$child_ht) #observed data
var(parent2child$resid) #residuals
var(main_dat$child_ht) #observed data
var(main_dat$child_ht) #observed data
var(parent2child$fitted) #fitted data
var(main_dat$child_ht) #observed data
var(parent2child$resid) #residuals
original_var_fit <- var(parent2child$fitted) #fitted data
original_var_obs <- var(main_dat$child_ht) #observed data
original_var_res <- var(parent2child$resid) #residuals
original_var_fit/original_var_obs
z_var_fit/z_var_obs
z_var_fit <- var(parent_z2child_z$fitted) #fitted data
z_var_obs <- var(main_dat$child_ht) #observed data
z_var_res <- var(parent_z2child_z$resid) #residuals
z_var_fit/z_var_obs
original_var_fit/original_var_obs
glance(parent2child)
glance(parent_z2child_z)
original_var_fit/original_var_obs
z_var_fit/z_var_obs
glance(parent_z2child_z)
z_var_obs <- var(main_dat$z_child_ht) #observed data
original_var_fit/original_var_obs
z_var_fit/z_var_obs
parent2child <- lm(child_ht ~ parent_ht, data = main_dat)
parent_z2child_z <- lm(z_child_ht ~ z_parent_ht, data = main_dat)
print(parent2child)
print(parent_z2child_z)
print(parent2child)
summary(parent2child)
parent_z2child_z <- lm(z_child_ht ~ z_parent_ht, data = main_dat)
print(parent_z2child_z)
summary(parent_z2child_z)
z_var_fit <- var(parent_z2child_z$fitted) #fitted data
z_var_obs <- var(main_dat$z_child_ht) #observed data
z_var_res <- var(parent_z2child_z$resid) #residuals
head(data)
library(gapminder)
head(data)
gapminder
data <- gapminder
head(data)
# Let's use the most recent year of data
gapminder_2007 <- gapminder %>%
filter(year == 2007)
# let's look at the distribution of GDP per capita
p1<- ggplot(gapminder_2007, aes(x = gdpPercap)) +
geom_histogram(bins = 30, fill = "skyblue", color = "black") +
scale_x_continuous(labels = scales::dollar_format()) +
labs(title = "Distribution of GDP per capita",
x = "GDP per capita", y = "Count") +
theme_minimal()
print (p1)
# Let's use the most recent year of data
gapminder_2007 <- gapminder %>%
filter(year == 2007) %>%
mutate(log_gdp = log(gdpPercap))
# Visualize the distribution of GDP per capita
p1 <- ggplot(gapminder_2007, aes(x = gdpPercap)) +
geom_histogram(bins = 30, fill = "skyblue", color = "black") +
scale_x_continuous(labels = scales::dollar_format()) +
labs(title = "Distribution of GDP per capita",
x = "GDP per capita", y = "Count") +
theme_minimal()
# Visualize the distribution of log(GDP per capita)
p2 <- ggplot(gapminder_2007, aes(x = log_gdp)) +
geom_histogram(bins = 30, fill = "lightgreen", color = "black") +
labs(title = "Distribution of log(GDP per capita)",
x = "log(GDP per capita)", y = "Count") +
theme_minimal()
# Display plots side by side
library(patchwork)
p1 + p2
# Visualize the distribution of GDP per capita
p1 <- ggplot(gapminder_2007, aes(x = gdpPercap)) +
geom_histogram(bins = 30, fill = "skyblue", color = "black") +
scale_x_continuous(labels = scales::dollar_format()) +
labs(title = "Distribution of GDP per capita",
x = "GDP per capita", y = "Count") +
theme_minimal()
# Visualize the distribution of log(GDP per capita)
p2 <- ggplot(gapminder_2007, aes(x = log_gdp)) +
geom_histogram(bins = 30, fill = "lightgreen", color = "black") +
labs(title = "Distribution of log(GDP per capita)",
x = "log(GDP per capita)", y = "Count") +
theme_minimal()
p1 + p2
print(p1 + p2)
print(p1, p2)
# Display plots side by side
library(patchwork)
# Display plots side by side
library(patchwork)
p1 + p2
# Display plots side by side
library(patchwork)
p1
p2
p1 + p2
p1
p2
p1 + p2 #???
# Display plots side by side
library(patchwork)
knitr::opts_chunk$set(echo = TRUE)
main_dat <- read.csv('galton_child_parent_heights.csv')
head(main_dat)
z_score <- function(x) {(x-mean(x))/sd(x)}
main_dat$z_child_ht <- z_score(main_dat$child_ht)
main_dat$z_parent_ht <- z_score(main_dat$parent_ht)
head(main_dat)
correlate(main_dat)
library(corrr)
correlate(main_dat)
cor_main_matrix <- correlate(main_dat)
rplot(cor_main_matrix)
correlate(main_dat)
library(ggplot2)
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_jitter(alpha = 0.3)
ggplot(main_dat, aes(x = parent_ht, y = child_ht)) +
geom_jitter(alpha = 0.3) +
geom_smooth(method = 'lm') +
annotate("text", x = 65, y = 72, label = "r = 0.459", color = "darkgreen", size = 5)
ggplot(main_dat, aes(x = z_parent_ht, y = z_child_ht)) +
geom_jitter(alpha = 0.3) +
geom_smooth(method = 'lm') +
annotate("text", x = -2, y = 1, label = "r = 0.459", color = "darkgreen", size = 5)
parent2child <- lm(child_ht ~ parent_ht, data = main_dat)
print(parent2child)
summary(parent2child)
parent_z2child_z <- lm(z_child_ht ~ z_parent_ht, data = main_dat)
print(parent_z2child_z)
summary(parent_z2child_z)
library(broom)
tidy(parent2child)
tidy(parent_z2child_z)
tidy(parent2child)
tidy(parent_z2child_z)
tidy(parent2child)
tidy(parent_z2child_z)
tidy(parent2child)
tidy(parent_z2child_z)
tidy(parent2child)
tidy(parent_z2child_z)
glance(parent2child)
glance(parent_z2child_z)
glance(parent2child)
glance(parent_z2child_z)
glance(parent2child)
glance(parent_z2child_z)
glance(parent2child)
glance(parent2child)
glance(parent_z2child_z)
glance(parent2child)
glance(parent_z2child_z)
glance(parent2child)
glance(parent_z2child_z)
augment(parent2child, data = main_dat)
raw_var_fit <- var(parent2child$fitted) #fitted data
raw_var_obs <- var(main_dat$child_ht) #observed data
raw_var_res <- var(parent2child$resid) #residuals
augment(parent_z2child_z, data = main_dat)
z_var_fit <- var(parent_z2child_z$fitted) #fitted data
z_var_obs <- var(main_dat$z_child_ht) #observed data
z_var_res <- var(parent_z2child_z$resid) #residuals
raw_var_fit
raw_var_obs
raw_var_res
z_var_fit
z_var_obs
z_var_res
raw_var_fit/raw_var_obs
z_var_fit/z_var_obs
z_var_fit/z_var_obs
library(gapminder)
gapminder
data <- gapminder
head(data)
# Let's use the most recent year of data
gapminder_2007 <- gapminder %>%
filter(year == 2007)
# Let's use the most recent year of data
gapminder_2007 <- gapminder %>%
filter(year == 2007)
library(gapminder)
gapminder
data <- gapminder
head(data)
# Let's use the most recent year of data
gapminder_2007 <- gapminder %>%
filter(year == 2007)
library(gapminder)
# Let's use the most recent year of data
gapminder_2007 <- gapminder %>%
filter(year == 2007)
# Let's use the most recent year of data
gapminder_2007 <- gapminder %>%
filter(year == 2007)
# Let's use the most recent year of data
gapminder_2007 <- gapminder %>%
filter(year == 2007)
library(dplyr)
library(tidyverse)
# Let's use the most recent year of data
gapminder_2007 <- gapminder %>%
filter(year == 2007)
# let's look at the distribution of GDP per capita
p1<- ggplot(gapminder_2007, aes(x = gdpPercap)) +
geom_histogram(bins = 30, fill = "skyblue", color = "black") +
scale_x_continuous(labels = scales::dollar_format()) +
labs(title = "Distribution of GDP per capita",
x = "GDP per capita", y = "Count") +
theme_minimal()
print (p1)
# Let's use the most recent year of data
gapminder_2007 <- gapminder %>%
filter(year == 2007) %>%
mutate(log_gdp = log(gdpPercap))
# Visualize the distribution of GDP per capita
p1 <- ggplot(gapminder_2007, aes(x = gdpPercap)) +
geom_histogram(bins = 30, fill = "skyblue", color = "black") +
scale_x_continuous(labels = scales::dollar_format()) +
labs(title = "Distribution of GDP per capita",
x = "GDP per capita", y = "Count") +
theme_minimal()
# Visualize the distribution of log(GDP per capita)
p2 <- ggplot(gapminder_2007, aes(x = log_gdp)) +
geom_histogram(bins = 30, fill = "lightgreen", color = "black") +
labs(title = "Distribution of log(GDP per capita)",
x = "log(GDP per capita)", y = "Count") +
theme_minimal()
# Display plots side by side
library(patchwork)
p1
p2
p1 + p2 #???
# Display plots side by side
library(patchwork)
# Display plots side by side
library(patchwork)
library(ggplot2)
library(gapminder)
library(tidyverse)
# Display plots side by side
library(patchwork)
update.packages(ask = FALSE)
gapminder_dummy <- gapminder_2007 %>%
mutate(log_gdp = log(gdpPercap),
continent_America = as.integer(continent == "Americas"),
continent_Asia     = as.integer(continent == "Asia"),
continent_Europe   = as.integer(continent == "Europe"),
continent_Oceania  = as.integer(continent == "Oceania"))
head(gapminder_dummy)
gapminder
model_A <- lm(log_gdp ~ 1, data = gapminder_2007)
summary(model_A)
model_B <- lm(log_gdp ~ cont_Americas + cont_Asia + cont_Europe + cont_Oceania,
data = gapminder_2007)
summary(model_B)
model_B <- lm(log_gdp ~ cont_Americas + cont_Asia + cont_Europe + cont_Oceania,
data = gapminder_2007)
model_B <- lm(log_gdp ~ continent_America + continent_Asia + continent_Europe + continent_Oceania,
data = gapminder_2007)
model_B <- lm(log_gdp ~ continent_Americas + continent_Asia + continent_Europe + continent_Oceania,
data = gapminder_2007)
gapminder_dummy <- gapminder_2007 %>%
mutate(log_gdp = log(gdpPercap),
continent_America = as.integer(continent == "Americas"),
continent_Asia     = as.integer(continent == "Asia"),
continent_Europe   = as.integer(continent == "Europe"),
continent_Oceania  = as.integer(continent == "Oceania"))
head(gapminder_dummy)
model_B <- lm(log_gdp ~ continent_America + continent_Asia + continent_Europe + continent_Oceania,
data = gapminder_2007)
model_A <- lm(log_gdp ~ 1, data = gapminder_dummy)
summary(model_A)
model_B <- lm(log_gdp ~ continent_America + continent_Asia + continent_Europe + continent_Oceania,
data = gapminder_dummy)
summary(model_B)
glance(model_A)
glance(model_B)
glance(model_A)
glance(model_B)
glance(model_A)
glance(model_B)
glance(model_B)
glance(model_A)
glance(model_B)
glance(model_A)
glance(model_B)
glance(model_A)
glance(model_B)
glance(model_A)
glance(model_B)
glance(model_A)
glance(model_B)
glance(model_A)
#added
model_C <-  lm(log_gdp ~ continent_America + continent_Asia + continent_Europe + continent_Oceania, data = gapminder_dummy)
model_B_auto <- lm(log_gdp ~ continent, data = gapminder_2007)
summary(model_B_auto)
glance(model_B_auto)
glance(model_B)
ggplot(gapminder_2007, aes(x = continent, y = log_gdp)) +
geom_jitter(width = 0.2, alpha = 0.6, color = "darkgray") +
geom_boxplot(alpha = 0.4, outlier.shape = NA, fill = "skyblue") +
labs(title = "Log(GDP per capita) by Continent (2007)",
x = "Continent",
y = "log(GDP per capita)") +
theme_minimal(base_size = 13)
ggplot(gapminder_2007, aes(x = continent, y = log_gdp)) +
geom_jitter(width = 0.2, alpha = 0.6, color = "darkgray") +
geom_boxplot(alpha = 0.4, outlier.shape = NA, fill = "skyblue") +
labs(x = "Continent",
y = "log GDP") +
theme_minimal(base_size = 13)
ggplot(gapminder_2007, aes(x = continent, y = log_gdp)) +
geom_jitter(width = 0.2, alpha = 0.6, color = "darkgray") +
geom_boxplot(alpha = 0.4, outlier.shape = NA, fill = "skyblue") +
labs(x = "Continent",
y = "log GDP")
ggplot(gapminder_2007, aes(x = continent, y = log_gdp)) +
geom_jitter(width = 0.2, alpha = 0.6, color = "darkgray") +
geom_boxplot(alpha = 0.4, outlier.shape = NA, fill = "skyblue") +
labs(x = "Continent",
y = "log GDP") +
theme_minimal(base_size = 13)
ggplot(gapminder_2007, aes(x = continent, y = log_gdp)) +
geom_jitter(width = 0.2, alpha = 0.6, color = "darkgray") +
geom_boxplot(alpha = 0.4, outlier.shape = NA, fill = "skyblue") +
labs(x = "Continent",
y = "log GDP")
print (summary(model_C))
# Display plots side by side
library(patchwork)
p1 + p2
