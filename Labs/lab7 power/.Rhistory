# samples A and B come from the same normal distribution
A <- rnorm(n=10,mean=10, sd=5)
B <- rnorm(n=10,mean=10, sd=5)
# let's run the t-test for this one pretend simulation
t.test(A,B,var.equal=TRUE)
# let's explore using lm() to ask the same question
Outcome <- c(A, B)
group <- factor(rep(c("A","B"), each=10))
summary(lm(Outcome ~ group))
# running the simulation
# everytime we run this function we do one simulated experiment and return the p-value
sim_null <- function(){
A <- rnorm(n=10,mean=10, sd=5)
B <- rnorm(n=10,mean=10, sd=5)
return(t.test(A,B,var.equal=TRUE)$p.value)
}
# use replicate to run the sim many times
outcomes <- replicate(1000,sim_null())
# plot the null-distribution of p-values
hist(outcomes)
# proportion of simulated experiments that had a p-value less than .05
length(outcomes[outcomes<.05])/1000
#Example of a single test
A <- rnorm(n=10,mean=10, sd=5)
B <- rnorm(n=10,mean=15, sd=5)
t.test(A,B,var.equal=TRUE)
# simulations: make the mean for B 15 (5 more than A)
sim_alternative <- function(){
A <- rnorm(n=10,mean=10, sd=5)
B <- rnorm(n=10,mean=15, sd=5)
return(t.test(A,B,var.equal=TRUE)$p.value)
}
# use replicate to run the sim many times
outcomes <- replicate(1000,sim_alternative())
# plot the distribution of p-values
hist(outcomes)
# proportion of simulated experiments had a p-value less than .05
length(outcomes[outcomes<.05])/1000
# plot the distribution of p-values
hist(outcomes)
# proportion of simulated experiments had a p-value less than .05
length(outcomes[outcomes<.05])/1000
# plot the distribution of p-values
hist(outcomes)
library(pwr)
# Your answer here
A <- rnorm(n=10,mean=10, sd=5)
B <- rnorm(n=10,mean=15, sd=5)
t.test(A,B,var.equal=TRUE)
pwr.t.test(A,B,var.equal=TRUE)
pwr.t.test(A,B,var.equal=FAKSE)
pwr.t.test(A,B,var.equal=FALSE)
pwr.t.test(A,B)
?pwr.t.test
# proportion of simulated experiments had a p-value less than .05
length(outcomes[outcomes<.05])/1000
t.test(A,B,var.equal=TRUE)
pwr.t.test(n = 10, d = 1, sig.level = 0.05, power = NULL,
type = c("two.sample"),
alternative = c("two.sided"))
# function to run a simulated t-test
sim_power <- function(x){
A <- rnorm(n=10, mean=0, sd=1)
B <- rnorm(n=10, mean=(0+x), sd=1)
return(t.test(A,B, var.equal=TRUE)$p.value)
}
#----- edit for answer (a) below
sim_power(2)
#----- edit for answer (a) below
?seq
#----- edit for answer (a) below
effect_sizes <- seq(0,2)
#----- edit for answer (a) below
effect_sizes <- seq(0,2,10)
#----- edit for answer (a) below
effect_sizes <- seq(0,2,length.out=10)
power <- c()  # empty vector to store results
for(i in 1:length(effect_sizes)) {
sims <- replicate(1000, sim_power(effect_sizes[i]))
power[i] <- length(sims[sims<.05])/length(sims)
}
plot_df <- data.frame(effect_sizes,power)
library(ggplot2)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
num_subjects <- seq(10,1000,10)
?pwr
?pwr.t.test
#Your answer here
power <- c()
for (i in 1:length(num_subjects)) {
power[i] <- pwr.t.test(n = num_subjects[i], d = 0.5, sig.level = 0.05,
type = "two.sampe", alternative = "two.sided")
}
for (i in 1:length(num_subjects)) {
power[i] <- pwr.t.test(n = num_subjects[i], d = 0.5, sig.level = 0.05,
type = "two.sample", alternative = "two.sided")
}
num_subjects <- seq(10,1000,10)
#Your answer here
power <- c()
for (i in 1:length(num_subjects)) {
power[i] <- pwr.t.test(n = num_subjects[i], d = 0.3, sig.level = 0.05,
type = "two.sample", alternative = "two.sided")
}
power
#Your answer here
power <- c()
plot_df <- data.frame(num_subjects,power)
library(ggplot2)
ggplot(plot_df, aes(x=num_subjects,
y=power))+
geom_point()+
geom_line()
plot_df <- data.frame(num_subjects,power)
for (i in 1:length(num_subjects)) {
power[i] <- pwr.t.test(n = num_subjects[i], d = 0.3, sig.level = 0.05,
type = "two.sample", alternative = "two.sided")
}
plot_df <- data.frame(num_subjects,power)
library(ggplot2)
ggplot(plot_df, aes(x=num_subjects,
y=power))+
geom_point()+
geom_line()
#----- edit for answer (a) below
effect_sizes <- seq(0,2,length.out=10)
power <- c()  # empty vector to store results
for(i in 1:length(effect_sizes)) {
sims <- replicate(1000, sim_power(effect_sizes[i]))
power[i] <- length(sims[sims<.05])/length(sims)
}
for(i in 1:length(effect_sizes)) {
sims <- replicate(1000, sim_power(effect_sizes[i]))
power[i] <- length(sims[sims<.05])/length(sims)
}
plot_df <- data.frame(effect_sizes,power)
library(ggplot2)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
num_subjects <- seq(10,1000,10)
#Your answer here
power <- c()
for (i in 1:length(num_subjects)) {
power[i] <- pwr.t.test(n = num_subjects[i], d = 0.3, sig.level = 0.05,
type = "two.sample", alternative = "two.sided")
}
plot_df <- data.frame(num_subjects,power)
#library(ggplot2)
ggplot(plot_df, aes(x=num_subjects,
y=power))+
geom_point()+
geom_line()
#Your answer here
power <- c()
for (i in 1:length(num_subjects)) {
power[i] <- pwr.t.test(n = num_subjects[i], d = 0.3, sig.level = 0.05,
type = "two.sample", alternative = "two.sided")$power
}
plot_df <- data.frame(num_subjects,power)
#library(ggplot2)
ggplot(plot_df, aes(x=num_subjects,
y=power))+
geom_point()+
geom_line()
# function to run a simulated t-test
sim_power <- function(x){
A <- rnorm(n=10,mean=0, sd=1)
B <- rnorm(n=10,mean=(0+x), sd=1)
return(t.test(A,B,var.equal=TRUE)$p.value)
}
# vector of effect sizes
effect_sizes <- seq(.1,2,.1)
# run simulation for each effect size 1000 times
# (this is an alternate way to do what loops were doing)
power <- sapply(effect_sizes,
FUN = function(x) {
sims <- replicate(1000,sim_power(x))
sim_power <- length(sims[sims<.05])/length(sims)
return(sim_power)})
# run simulation for each effect size 1000 times
# (this is an alternate way to do what loops were doing)
power <- sapply(effect_sizes,
FUN = function(x) {
sims <- replicate(1000,sim_power(x))
sim_power <- length(sims[sims<.05])/length(sims)
return(sim_power)})
# combine into dataframe
plot_df <- data.frame(effect_sizes,power)
# plot the power curve
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
#----- edit for answer (a) below
#effect_sizes <- seq(0,2,length.out=10)
effect_sizes <- seq(.1,2,.1)
power <- c()  # empty vector to store results
for(i in 1:length(effect_sizes)) {
sims <- replicate(1000, sim_power(effect_sizes[i]))
power[i] <- length(sims[sims<.05])/length(sims)
}
for(i in 1:length(effect_sizes)) {
sims <- replicate(1000, sim_power(effect_sizes[i]))
power[i] <- length(sims[sims<.05])/length(sims)
}
plot_df <- data.frame(effect_sizes,power)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
#----- edit for answer (a) below
effect_sizes <- seq(0,2,length.out=10)
power <- c()  # empty vector to store results
plot_df <- data.frame(effect_sizes,power)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
power <- c()  # empty vector to store results
for(i in 1:length(effect_sizes)) {
sims <- replicate(1000, sim_power(effect_sizes[i]))
power[i] <- length(sims[sims<.05])/length(sims)
}
for(i in 1:length(effect_sizes)) {
sims <- replicate(1000, sim_power(effect_sizes[i]))
power[i] <- length(sims[sims<.05])/length(sims)
}
plot_df <- data.frame(effect_sizes,power)
plot_df <- data.frame(effect_sizes,power)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
# function to run a simulated t-test
sim_power <- function(x){
A <- rnorm(n=10,mean=0, sd=1)
B <- rnorm(n=10,mean=(0+x), sd=1)
return(t.test(A,B,var.equal=TRUE)$p.value)
}
# vector of effect sizes
effect_sizes <- seq(.1,2,.1)
# run simulation for each effect size 1000 times
# (this is an alternate way to do what loops were doing)
power <- sapply(effect_sizes,
FUN = function(x) {
sims <- replicate(1000,sim_power(x))
sim_power <- length(sims[sims<.05])/length(sims)
return(sim_power)})
# run simulation for each effect size 1000 times
# (this is an alternate way to do what loops were doing)
power <- sapply(effect_sizes,
FUN = function(x) {
sims <- replicate(1000,sim_power(x))
sim_power <- length(sims[sims<.05])/length(sims)
return(sim_power)})
# combine into dataframe
plot_df <- data.frame(effect_sizes,power)
# plot the power curve
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
# function to run a simulated t-test
sim_power <- function(x){
A <- rnorm(n=10,mean=0, sd=1)
B <- rnorm(n=10,mean=(0+x), sd=1)
return(t.test(A,B,var.equal=TRUE)$p.value)
}
# vector of effect sizes
effect_sizes <- seq(.1,2,.1)
# run simulation for each effect size 1000 times
# (this is an alternate way to do what loops were doing)
power <- sapply(effect_sizes,
FUN = function(x) {
sims <- replicate(10000,sim_power(x))
sim_power <- length(sims[sims<.05])/length(sims)
return(sim_power)})
# run simulation for each effect size 1000 times
# (this is an alternate way to do what loops were doing)
power <- sapply(effect_sizes,
FUN = function(x) {
sims <- replicate(10000,sim_power(x))
sim_power <- length(sims[sims<.05])/length(sims)
return(sim_power)})
# combine into dataframe
plot_df <- data.frame(effect_sizes,power)
# plot the power curve
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
# function to run a simulated t-test
sim_power <- function(x){
A <- rnorm(n=10,mean=0, sd=1)
B <- rnorm(n=10,mean=(0+x), sd=1)
return(t.test(A,B,var.equal=TRUE)$p.value)
}
# vector of effect sizes
effect_sizes <- seq(.1,2,.1)
# run simulation for each effect size 1000 times
# (this is an alternate way to do what loops were doing)
power <- sapply(effect_sizes,
FUN = function(x) {
sims <- replicate(1000,sim_power(x))
sim_power <- length(sims[sims<.05])/length(sims)
return(sim_power)})
# run simulation for each effect size 1000 times
# (this is an alternate way to do what loops were doing)
power <- sapply(effect_sizes,
FUN = function(x) {
sims <- replicate(1000,sim_power(x))
sim_power <- length(sims[sims<.05])/length(sims)
return(sim_power)})
# combine into dataframe
plot_df <- data.frame(effect_sizes,power)
# plot the power curve
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
